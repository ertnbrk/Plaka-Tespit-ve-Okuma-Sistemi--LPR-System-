<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Akıllı Şehir Plaka Sistemi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gov: {
                            bg: '#0B2A4A',
                            card: '#123E6B',
                            dark: '#0A1F36',
                            red: '#E11D2E',
                            border: '#1E3A5F'
                        }
                    }
                }
            }
        }
    </script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@500;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            background-color: #0B2A4A;
            font-family: 'Inter', sans-serif;
        }

        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0A1F36;
        }

        ::-webkit-scrollbar-thumb {
            background: #1E3A5F;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #2D5485;
        }
    </style>
</head>

<body class="h-screen overflow-hidden flex flex-col">

    <!-- header stuff -->

    <header
        class="bg-[#0A1F36] border-b border-[#1E3A5F] h-16 flex items-center justify-between px-4 md:px-6 z-10 shadow-md flex-shrink-0">
        <div class="flex items-center space-x-2 md:space-x-4">
            <div class="w-8 h-8 md:w-10 md:h-10 flex items-center justify-center">
                <img src="../public/images/logo.png" alt="Logo" class="w-full h-full object-contain">
            </div>
            <h1 class="text-lg md:text-xl font-bold text-white tracking-wide">PLAKA SİSTEMİ <span
                    class="hidden md:inline text-red-500 text-xs ml-1 font-normal tracking-wider border border-red-500 rounded px-1">RESMİ
                    HİZMET</span></h1>
        </div>
        <div class="flex items-center space-x-3 md:space-x-6">
            <div class="text-right hidden md:block">
                <div id="user-name-display" class="text-sm font-medium text-white">Kullanıcı</div>
                <div class="text-xs text-gray-500">Müfettiş / Operatör</div>
            </div>
            <button onclick="localStorage.removeItem('token'); window.location.href='login.html'"
                class="text-gray-400 hover:text-white transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                    </path>
                </svg>
            </button>
        </div>
    </header>

    <div class="flex flex-1 flex-col md:flex-row overflow-hidden">

        <!-- sidebar (navigation) -->

        <aside
            class="w-full md:w-80 bg-[#0A1F36] border-b md:border-b-0 md:border-r border-[#1E3A5F] flex flex-col flex-shrink-0 order-2 md:order-1 max-h-[40vh] md:max-h-full">
            <div class="p-4 border-b border-[#1E3A5F]">
                <button onclick="document.getElementById('newComplaintModal').classList.remove('hidden');"
                    class="block w-full text-center bg-[#E11D2E] hover:bg-red-700 text-white py-3 rounded font-bold shadow-lg transition-colors">
                    + YENİ ŞİKAYET OLUŞTUR
                </button>
            </div>
            <div class="flex-1 overflow-y-auto p-4">
                <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Geçmiş Bildirimler</h3>
                <div id="complaints-list">
                    <!-- js will put stuff here -->

                </div>
            </div>
        </aside>

        <!-- main area -->

        <main class="flex-1 overflow-y-auto p-4 md:p-8 relative order-1 md:order-2">

            <div class="max-w-4xl mx-auto space-y-6 md:space-y-8">

                <!-- scary warning modal -->

                <div id="newComplaintModal"
                    class="hidden fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4">
                    <div class="bg-[#123E6B] border border-[#1E3A5F] rounded-lg max-w-sm w-full shadow-2xl">
                        <div class="p-6 text-center">
                            <div
                                class="w-16 h-16 bg-yellow-900/40 rounded-full flex items-center justify-center mx-auto mb-4 border border-yellow-700/50">
                                <svg class="w-8 h-8 text-yellow-500" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
                                    </path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-white mb-2">Dikkat</h3>
                            <p class="text-gray-300 text-sm mb-6">
                                Yeni şikayet oluşturmak için lütfen önce buradan bir plaka görseli/videosu yükleyip
                                analiz ediniz.
                            </p>
                            <button
                                onclick="document.getElementById('newComplaintModal').classList.add('hidden'); document.getElementById('drop-zone').scrollIntoView({ behavior: 'smooth' });"
                                class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded font-bold shadow-lg transition-colors w-full">
                                ANLAŞILDI
                            </button>
                        </div>
                    </div>
                </div>

                <!-- big action card -->

                <div class="bg-[#123E6B] border border-[#1E3A5F] rounded-lg shadow-xl overflow-hidden">
                    <div
                        class="bg-[#0A1F36] border-b border-[#1E3A5F] px-4 md:px-6 py-4 flex flex-col md:flex-row justify-between items-center space-y-3 md:space-y-0">
                        <h2 class="text-lg font-bold text-white flex items-center">
                            <svg class="w-5 h-5 mr-3 text-red-500" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                </path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            MEDYA ANALİZ MERKEZİ
                        </h2>
                        <!-- tabs for switching -->

                        <div class="flex space-x-1 bg-[#1e3a5f] p-1 rounded w-full md:w-auto justify-center">
                            <button id="tab-image"
                                class="flex-1 md:flex-none px-4 py-1.5 rounded text-sm font-medium bg-blue-900 text-white shadow-sm transition-all text-center">Görsel</button>
                            <button id="tab-video"
                                class="flex-1 md:flex-none px-4 py-1.5 rounded text-sm font-medium text-gray-400 hover:text-white transition-all text-center">Video</button>
                        </div>
                    </div>

                    <div class="p-4 md:p-8">
                        <!-- video takes time warning -->

                        <div id="video-warning" class="hidden mb-6 bg-yellow-900/40 border-l-4 border-yellow-500 p-4">
                            <div class="flex items-center">
                                <svg class="w-6 h-6 text-yellow-500 mr-3" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
                                    </path>
                                </svg>
                                <p class="text-sm text-yellow-200">Video analizi işlem yoğunluğu nedeniyle kuyruğa
                                    eklenebilir.</p>
                            </div>
                        </div>

                        <!-- drop file here -->

                        <div id="drop-zone"
                            class="border-2 border-dashed border-[#1E3A5F] rounded-lg p-6 md:p-12 text-center bg-[#0B2A4A] bg-opacity-50 cursor-pointer hover:bg-opacity-100 hover:border-blue-500 transition-all group">
                            <input type="file" id="file-input" class="hidden">
                            <div class="mb-4 text-gray-400 group-hover:text-blue-400 transition-colors">
                                <svg class="w-12 h-12 md:w-16 md:h-16 mx-auto" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                        d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12">
                                    </path>
                                </svg>
                            </div>
                            <p class="text-base md:text-lg text-gray-300 font-medium">Dosyayı buraya sürükleyin veya
                                tıklayın</p>
                            <p id="file-name-display" class="mt-4 text-green-400 font-mono hidden truncate"></p>
                        </div>

                        <!-- button to start magic -->

                        <div class="mt-6 flex justify-end">
                            <button id="analyze-btn" disabled
                                class="bg-[#E11D2E] text-white px-8 py-3 rounded font-bold shadow-lg opacity-50 cursor-not-allowed transition-all flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z">
                                    </path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                ANALİZİ BAŞLAT
                            </button>
                        </div>
                    </div>
                </div>

                <!-- spinning wheel -->

                <div id="loading-spinner" class="hidden text-center py-12">
                    <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500">
                    </div>
                    <p class="text-gray-400 mt-4 animate-pulse">Tespit ve OCR işlemi yapılıyor...</p>
                </div>

                <div id="results-area"
                    class="hidden bg-[#123E6B] border border-[#1E3A5F] rounded-lg shadow-xl p-6 animate-fade-in-up">
                    <h3
                        class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 border-b border-[#1E3A5F] pb-2">
                        Analiz Raporu</h3>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <!-- image/video preview -->

                        <div
                            class="bg-black rounded-lg overflow-hidden border border-gray-700 flex items-center justify-center min-h-[300px]">
                            <img id="result-image-display" class="max-w-full max-h-[400px]" alt="Sonuç">
                            <div id="video-placeholder" class="hidden text-gray-500">Video Analiz Sonucu Tablosu</div>
                        </div>

                        <!-- results go here -->

                        <div id="results-content" class="space-y-4">
                            <!-- dynamic stuff -->

                        </div>
                    </div>
                </div>

            </div>

            <!-- footer (ignored usually) -->

            <div class="absolute bottom-4 left-0 w-full text-center text-xs text-gray-600 pointer-events-none">
                SİSTEM SÜRÜM V2.0.4 - GÜVENLİ BAĞLANTI
            </div>
        </main>
    </div>

    <!-- js files -->

    <script src="../js/api.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/complaints.js"></script>
    <script src="../js/ui.js"></script>
    <script src="../js/upload.js"></script>
    <script>
        // Init Global controllers
        window.ui = new window.UIController();
        new window.UploadController((data, mode) => window.ui.showResult(data, mode));
    </script>
</body>

</html>